<!DOCTYPE html>
<html>
{%load static%}
<head>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<script src='./dist/fhir-client-v2.js'>
		console.log("successfully loaded the files")
	</script>
</head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
.buttonload {
  background-color: #04AA6D; /* Green background */
  border: none; /* Remove borders */
  color: white; /* White text */
  padding: 12px 24px; /* Some padding */
  font-size: 16px; /* Set a font-size */
}

/* Add a right margin to each icon */
.fa {
  margin-left: -12px;
  margin-right: 8px;
}
</style>
<body>
<!--	<h1 class="container" align="left">Hello, I am the page "launch.html"</h1>-->
	<br>
<button class="buttonload">
  <i class="fa fa-spinner fa-spin"></i>Authorizing
</button>
	<h1 class="container">Authorizing Request....</h1>

	<script>
/*		FHIR.oauth2.authorize({
      'client_id': '12d221e3-f893-408f-bba2-b9cf72e6438e',
      'scope':  'PATIENT.READ, PATIENT.SEARCH, OBSERVATION.READ, OBSERVATION.SEARCH',
      'redirect_uri': 'https://pmukasa.github.io/epicpatientapp/app.html',
      'iss': 'https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4'
    }); */

const crypto = require('crypto');

function generateStateValue(length = 32) {
    return crypto.randomBytes(length).toString('hex');
}

const state = generateStateValue();
/*console.log(state);*/

		FHIR.oauth2.authorize({
			'client_id': 'a19866e8-bdf3-4f53-85c8-7e399b4154fe',
			'scope': 'PATIENT.READ, PATIENT.SEARCH, OBSERVATION.READ, OBSERVATION.SEARCH',
			'state': state
			'redirect_uri': 'https://pmukasa.github.io/epicpatientapp/app.html',
			'iss': 'https://fhir-myrecord.cerner.com/r4/ec2458f2-1e24-41c8-b71b-0e701af7583d'
		});
	</script>

</body>

</html>
